// Generated by psc version 0.9.1
"use strict";
var Prelude = require("../Prelude");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class");
var Control_Monad_State = require("../Control.Monad.State");
var Data_Array = require("../Data.Array");
var Data_Int_Bits = require("../Data.Int.Bits");
var Data_Maybe = require("../Data.Maybe");
var Optic_Getter = require("../Optic.Getter");
var Optic_Lens = require("../Optic.Lens");
var Optic_Setter = require("../Optic.Setter");
var Samph_Types = require("../Samph.Types");
var Control_Monad_State_Class = require("../Control.Monad.State.Class");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Const = require("../Data.Const");
var Data_Profunctor = require("../Data.Profunctor");
var Data_Identity = require("../Data.Identity");
var Data_Function = require("../Data.Function");
var Data_Ring = require("../Data.Ring");
var Control_Bind = require("../Control.Bind");
var Control_Applicative = require("../Control.Applicative");
var Data_Eq = require("../Data.Eq");
var Data_Semiring = require("../Data.Semiring");
var Data_Ord = require("../Data.Ord");
var Data_Show = require("../Data.Show");
var Data_Functor = require("../Data.Functor");
var Control_Apply = require("../Control.Apply");
var Data_Ordering = require("../Data.Ordering");
var Data_Unit = require("../Data.Unit");
var Data_EuclideanRing = require("../Data.EuclideanRing");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var CorruptedCode = (function () {
    function CorruptedCode(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    CorruptedCode.create = function (value0) {
        return function (value1) {
            return new CorruptedCode(value0, value1);
        };
    };
    return CorruptedCode;
})();
var StackOverflow = (function () {
    function StackOverflow() {

    };
    StackOverflow.value = new StackOverflow();
    return StackOverflow;
})();
var StackUnderflow = (function () {
    function StackUnderflow() {

    };
    StackUnderflow.value = new StackUnderflow();
    return StackUnderflow;
})();
var IndexOutOfBounds = (function () {
    function IndexOutOfBounds(value0) {
        this.value0 = value0;
    };
    IndexOutOfBounds.create = function (value0) {
        return new IndexOutOfBounds(value0);
    };
    return IndexOutOfBounds;
})();
var InvalidPort = (function () {
    function InvalidPort(value0) {
        this.value0 = value0;
    };
    InvalidPort.create = function (value0) {
        return new InvalidPort(value0);
    };
    return InvalidPort;
})();
var Finished = (function () {
    function Finished() {

    };
    Finished.value = new Finished();
    return Finished;
})();
var uses = function (dictMonadState) {
    return function (l) {
        return function (f) {
            return Control_Monad_State_Class.gets(dictMonadState)(function ($301) {
                return f(Optic_Getter.view(l(Data_Const.functorConst))($301));
            });
        };
    };
};
var use = function (dictMonadState) {
    return function (l) {
        return Control_Monad_State_Class.gets(dictMonadState)(Optic_Getter.view(l(Data_Const.functorConst)));
    };
};
var subState = function (dictMonadState) {
    return function (dictRing) {
        return function (l) {
            return function (x) {
                return Control_Monad_State_Class.modify(dictMonadState)(Optic_Setter.over(Data_Profunctor.profunctorFn)(l(Data_Identity.functorIdentity))(Data_Function.flip(Data_Ring.sub(dictRing))(x)));
            };
        };
    };
};
var statusRegister = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return s.statusRegister;
    })(function (s) {
        return function (x) {
            var $152 = {};
            for (var $153 in s) {
                if (s.hasOwnProperty($153)) {
                    $152[$153] = s[$153];
                };
            };
            $152.statusRegister = x;
            return $152;
        };
    })(dictFunctor);
};
var stackPointer = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return s.stackPointer;
    })(function (s) {
        return function (x) {
            var $154 = {};
            for (var $155 in s) {
                if (s.hasOwnProperty($155)) {
                    $154[$155] = s[$155];
                };
            };
            $154.stackPointer = x;
            return $154;
        };
    })(dictFunctor);
};
var setState = function (dictMonadState) {
    return function (l) {
        return function (x) {
            return Control_Monad_State_Class.modify(dictMonadState)(Optic_Setter.set(l(Data_Identity.functorIdentity))(x));
        };
    };
};
var setArr = function (dictMonadError) {
    return function (dictMonadState) {
        return function (g) {
            return function (s) {
                return function (e) {
                    return function (v) {
                        return function (x) {
                            return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Monad_State_Class.gets(dictMonadState)(function ($302) {
                                return Data_Array.updateAt(v)(x)(g($302));
                            }))(function (v1) {
                                if (v1 instanceof Data_Maybe.Nothing) {
                                    return Control_Monad_Error_Class.throwError(dictMonadError)(e(v));
                                };
                                if (v1 instanceof Data_Maybe.Just) {
                                    return Control_Monad_State_Class.modify(dictMonadState)(s(v1.value0));
                                };
                                throw new Error("Failed pattern match at Samph.Runtime line 239, column 3 - line 241, column 27: " + [ v1.constructor.name ]);
                            });
                        };
                    };
                };
            };
        };
    };
};
var setIO = function (dictMonadError) {
    return function (dictMonadState) {
        return setArr(dictMonadError)(dictMonadState)(function (v) {
            return v.io;
        })(function (nr) {
            return function (ss) {
                var $164 = {};
                for (var $165 in ss) {
                    if (ss.hasOwnProperty($165)) {
                        $164[$165] = ss[$165];
                    };
                };
                $164.io = nr;
                return $164;
            };
        })(InvalidPort.create);
    };
};
var setRam = function (dictMonadError) {
    return function (dictMonadState) {
        return setArr(dictMonadError)(dictMonadState)(function (v) {
            return v.ram;
        })(function (nr) {
            return function (ss) {
                var $166 = {};
                for (var $167 in ss) {
                    if (ss.hasOwnProperty($167)) {
                        $166[$167] = ss[$167];
                    };
                };
                $166.ram = nr;
                return $166;
            };
        })(IndexOutOfBounds.create);
    };
};
var regLens = function (v) {
    return function (dictFunctor) {
        if (v instanceof Samph_Types.AL) {
            return Optic_Lens.lens(function (st) {
                return st.al;
            })(function (st) {
                return function (x) {
                    var $169 = {};
                    for (var $170 in st) {
                        if (st.hasOwnProperty($170)) {
                            $169[$170] = st[$170];
                        };
                    };
                    $169.al = x;
                    return $169;
                };
            })(dictFunctor);
        };
        if (v instanceof Samph_Types.BL) {
            return Optic_Lens.lens(function (st) {
                return st.bl;
            })(function (st) {
                return function (x) {
                    var $171 = {};
                    for (var $172 in st) {
                        if (st.hasOwnProperty($172)) {
                            $171[$172] = st[$172];
                        };
                    };
                    $171.bl = x;
                    return $171;
                };
            })(dictFunctor);
        };
        if (v instanceof Samph_Types.CL) {
            return Optic_Lens.lens(function (st) {
                return st.cl;
            })(function (st) {
                return function (x) {
                    var $173 = {};
                    for (var $174 in st) {
                        if (st.hasOwnProperty($174)) {
                            $173[$174] = st[$174];
                        };
                    };
                    $173.cl = x;
                    return $173;
                };
            })(dictFunctor);
        };
        if (v instanceof Samph_Types.DL) {
            return Optic_Lens.lens(function (st) {
                return st.dl;
            })(function (st) {
                return function (x) {
                    var $175 = {};
                    for (var $176 in st) {
                        if (st.hasOwnProperty($176)) {
                            $175[$176] = st[$176];
                        };
                    };
                    $175.dl = x;
                    return $175;
                };
            })(dictFunctor);
        };
        throw new Error("Failed pattern match at Samph.Runtime line 175, column 1 - line 175, column 60: " + [ v.constructor.name ]);
    };
};
var ram = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return s.ram;
    })(function (s) {
        return function (x) {
            var $177 = {};
            for (var $178 in s) {
                if (s.hasOwnProperty($178)) {
                    $177[$178] = s[$178];
                };
            };
            $177.ram = x;
            return $177;
        };
    })(dictFunctor);
};
var push = function (x) {
    return function (dictMonadState) {
        return function (dictMonadError) {
            return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                return stackPointer(dictFunctor);
            }))(function (v) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Data_Eq.eq(Samph_Types.eqLit)(v)(255))(Control_Monad_Error_Class.throwError(dictMonadError)(StackOverflow.value)))(function () {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(setRam(dictMonadError)(dictMonadState)(v)(x))(function () {
                        return subState(dictMonadState)(Samph_Types.ringLit)(function (dictFunctor) {
                            return stackPointer(dictFunctor);
                        })(1);
                    });
                });
            });
        };
    };
};
var plusState = function (dictMonadState) {
    return function (dictSemiring) {
        return function (l) {
            return function (x) {
                return Control_Monad_State_Class.modify(dictMonadState)(Optic_Setter.over(Data_Profunctor.profunctorFn)(l(Data_Identity.functorIdentity))(Data_Function.flip(Data_Semiring.add(dictSemiring))(x)));
            };
        };
    };
};
var io = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return s.io;
    })(function (s) {
        return function (x) {
            var $180 = {};
            for (var $181 in s) {
                if (s.hasOwnProperty($181)) {
                    $180[$181] = s[$181];
                };
            };
            $180.io = x;
            return $180;
        };
    })(dictFunctor);
};
var instructionPointer = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return s.instructionPointer;
    })(function (s) {
        return function (x) {
            var $182 = {};
            for (var $183 in s) {
                if (s.hasOwnProperty($183)) {
                    $182[$183] = s[$183];
                };
            };
            $182.instructionPointer = x;
            return $182;
        };
    })(dictFunctor);
};
var jmp = function (dictMonadState) {
    return function (i) {
        return setState(dictMonadState)(function (dictFunctor) {
            return instructionPointer(dictFunctor);
        })(i);
    };
};
var initialState = {
    ram: [  ], 
    al: 0, 
    bl: 0, 
    cl: 0, 
    dl: 0, 
    instructionPointer: 0, 
    statusRegister: 0, 
    stackPointer: 191, 
    io: [  ]
};
var getLit = function (v) {
    return v;
};
var set = function (n) {
    return function (s) {
        return function (v) {
            if (v) {
                var $188 = {};
                for (var $189 in s) {
                    if (s.hasOwnProperty($189)) {
                        $188[$189] = s[$189];
                    };
                };
                $188.statusRegister = Data_Int_Bits.or(getLit(s.statusRegister))(n);
                return $188;
            };
            if (!v) {
                var $190 = {};
                for (var $191 in s) {
                    if (s.hasOwnProperty($191)) {
                        $190[$191] = s[$191];
                    };
                };
                $190.statusRegister = Data_Int_Bits.and(getLit(s.statusRegister))(~n);
                return $190;
            };
            throw new Error("Failed pattern match at Samph.Runtime line 60, column 1 - line 60, column 75: " + [ n.constructor.name, s.constructor.name, v.constructor.name ]);
        };
    };
};
var interrupt = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return Data_Int_Bits.and(getLit(s.statusRegister))(8) > 0;
    })(set(8))(dictFunctor);
};
var overflow = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return Data_Int_Bits.and(getLit(s.statusRegister))(32) > 0;
    })(set(32))(dictFunctor);
};
var underflow = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return Data_Int_Bits.and(getLit(s.statusRegister))(16) > 0;
    })(set(16))(dictFunctor);
};
var zeroFlag = function (dictFunctor) {
    return Optic_Lens.lens(function (s) {
        return Data_Int_Bits.and(getLit(s.statusRegister))(64) > 0;
    })(set(64))(dictFunctor);
};
var getArr = function (dictMonadError) {
    return function (dictMonadState) {
        return function (e) {
            return function (l) {
                return function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Monad_State_Class.gets(dictMonadState)(l))(function (v1) {
                        var $196 = Data_Array.index(v1)(v);
                        if ($196 instanceof Data_Maybe.Nothing) {
                            return Control_Monad_Error_Class.throwError(dictMonadError)(e(v));
                        };
                        if ($196 instanceof Data_Maybe.Just) {
                            return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())($196.value0);
                        };
                        throw new Error("Failed pattern match at Samph.Runtime line 228, column 3 - line 230, column 21: " + [ $196.constructor.name ]);
                    });
                };
            };
        };
    };
};
var getIO = function (dictMonadError) {
    return function (dictMonadState) {
        return getArr(dictMonadError)(dictMonadState)(InvalidPort.create)(function (v) {
            return v.io;
        });
    };
};
var getRam = function (dictMonadError) {
    return function (dictMonadState) {
        return getArr(dictMonadError)(dictMonadState)(IndexOutOfBounds.create)(function (v) {
            return v.ram;
        });
    };
};
var pop = function (dictMonadState) {
    return function (dictMonadError) {
        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
            return stackPointer(dictFunctor);
        }))(function (v) {
            return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Data_Eq.eq(Samph_Types.eqLit)(v)(191))(Control_Monad_Error_Class.throwError(dictMonadError)(StackUnderflow.value)))(function () {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(v))(function (v1) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(plusState(dictMonadState)(Samph_Types.semiRingLit)(function (dictFunctor) {
                        return stackPointer(dictFunctor);
                    })(1))(function () {
                        return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(v1);
                    });
                });
            });
        });
    };
};
var popLit = function (dictMonadState) {
    return function (dictMonadError) {
        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
            return instructionPointer(dictFunctor);
        }))(function (v) {
            return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(v))(function (v1) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(plusState(dictMonadState)(Samph_Types.semiRingLit)(function (dictFunctor) {
                    return instructionPointer(dictFunctor);
                })(1))(function () {
                    return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(v1);
                });
            });
        });
    };
};
var popReg = function (dictMonadState) {
    return function (dictMonadError) {
        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(popLit(dictMonadState)(dictMonadError))(function (v) {
            if (v === 0) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.AL.value);
            };
            if (v === 1) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.BL.value);
            };
            if (v === 2) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.CL.value);
            };
            if (v === 3) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.DL.value);
            };
            return Control_Monad_Error_Class.throwError(dictMonadError)(new CorruptedCode("register", Data_Show.show(Data_Show.showInt)(v)));
        });
    };
};
var popIns = function (dictMonadState) {
    return function (dictMonadError) {
        var popAddrLit = Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(function (v) {
            return v;
        })(popLit(dictMonadState)(dictMonadError));
        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(popLit(dictMonadState)(dictMonadError))(function (v) {
            if (v === 160) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A0.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 161) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A1.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 162) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A2.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 163) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A3.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 164) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A4.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 165) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A5.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 166) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A6.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 170) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AA.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 171) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AB.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 172) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AC.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 173) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AD.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 169) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.A9.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 185) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B9.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 201) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C9.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 217) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D9.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 176) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B0.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 177) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B1.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 178) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B2.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 179) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B3.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 182) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.B6.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 186) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.BA.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 187) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.BB.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 188) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.BC.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 192) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C0.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 193) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C1.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 194) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C2.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 195) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C3.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 196) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C4.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 197) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C5.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 198) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.C6.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 202) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.CA.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 203) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.CB.value);
            };
            if (v === 204) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.CC.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 205) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.CD.value);
            };
            if (v === 224) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.E0.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 225) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.E1.create)(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 234) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.EA.value);
            };
            if (v === 235) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.EB.value);
            };
            if (v === 240) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.F0.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 241) {
                return Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.F1.create)(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 254) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.FE.value);
            };
            if (v === 0) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.O0.value);
            };
            if (v === 255) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.FF.value);
            };
            if (v === 252) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.FC.value);
            };
            if (v === 253) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Samph_Types.FD.value);
            };
            if (v === 208) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D0.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 209) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D1.create)(popReg(dictMonadState)(dictMonadError)))(popAddrLit);
            };
            if (v === 210) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D2.create)(popAddrLit))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 211) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D3.create)(popReg(dictMonadState)(dictMonadError)))(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AddrReg)(popReg(dictMonadState)(dictMonadError)));
            };
            if (v === 212) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.D4.create)(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.AddrReg)(popReg(dictMonadState)(dictMonadError))))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 218) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.DA.create)(popReg(dictMonadState)(dictMonadError)))(popReg(dictMonadState)(dictMonadError));
            };
            if (v === 219) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.DB.create)(popReg(dictMonadState)(dictMonadError)))(popLit(dictMonadState)(dictMonadError));
            };
            if (v === 220) {
                return Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Samph_Types.DC.create)(popReg(dictMonadState)(dictMonadError)))(popAddrLit);
            };
            return Control_Monad_Error_Class.throwError(dictMonadError)(new CorruptedCode("instruction", Data_Show.show(Data_Show.showInt)(v)));
        });
    };
};
var arith = function (dictMonadState) {
    return function (xreg) {
        return function (op) {
            var x = regLens(xreg);
            return Control_Bind.bind((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                return x(dictFunctor);
            }))(function (v) {
                var res = op(v);
                return Control_Bind.bind((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(setState(dictMonadState)(function (dictFunctor) {
                    return statusRegister(dictFunctor);
                })(0))(function () {
                    return Control_Bind.bind((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Applicative.when((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(res < 0)(setState(dictMonadState)(function (dictFunctor) {
                        return underflow(dictFunctor);
                    })(true)))(function () {
                        return Control_Bind.bind((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Applicative.when((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(res > 255)(setState(dictMonadState)(function (dictFunctor) {
                            return overflow(dictFunctor);
                        })(true)))(function () {
                            var wrp = Data_Int_Bits.and(res)(255);
                            return Control_Bind.bind((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(Control_Applicative.when((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(wrp === 0)(setState(dictMonadState)(function (dictFunctor) {
                                return zeroFlag(dictFunctor);
                            })(true)))(function () {
                                return setState(dictMonadState)(function (dictFunctor) {
                                    return x(dictFunctor);
                                })(wrp);
                            });
                        });
                    });
                });
            });
        };
    };
};
var binArith = function (dictMonadState) {
    return function (op) {
        return function (xreg) {
            return function (ylens) {
                return Control_Bind.bindFlipped((dictMonadState["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(arith(dictMonadState)(xreg))(uses(dictMonadState)(function (dictFunctor) {
                    return ylens(dictFunctor);
                })(function ($303) {
                    return op(getLit($303));
                }));
            };
        };
    };
};
var runInst = function (ins) {
    return function (dictMonadState) {
        return function (dictMonadError) {
            var c = function (v) {
                if (v instanceof Data_Ordering.LT) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return underflow(dictFunctor);
                    })(true);
                };
                if (v instanceof Data_Ordering.EQ) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return zeroFlag(dictFunctor);
                    })(true);
                };
                if (v instanceof Data_Ordering.GT) {
                    return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Data_Unit.unit);
                };
                throw new Error("Failed pattern match at Samph.Runtime line 352, column 5 - line 352, column 29: " + [ v.constructor.name ]);
            };
            if (ins instanceof Samph_Types.A0) {
                return binArith(dictMonadState)(Data_Semiring.add(Data_Semiring.semiringInt))(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.A1) {
                return binArith(dictMonadState)(Data_Ring.sub(Data_Ring.ringInt))(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.A2) {
                return binArith(dictMonadState)(Data_Semiring.mul(Data_Semiring.semiringInt))(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.A3) {
                return binArith(dictMonadState)(Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt))(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.A4) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v + 1 | 0;
                });
            };
            if (ins instanceof Samph_Types.A5) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v - 1;
                });
            };
            if (ins instanceof Samph_Types.A6) {
                return binArith(dictMonadState)(Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt))(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.AA) {
                return binArith(dictMonadState)(Data_Int_Bits.and)(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.AB) {
                return binArith(dictMonadState)(Data_Int_Bits.or)(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.AC) {
                return binArith(dictMonadState)(Data_Int_Bits.xor)(ins.value0)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                });
            };
            if (ins instanceof Samph_Types.AD) {
                return arith(dictMonadState)(ins.value0)(Data_Int_Bits.complement);
            };
            if (ins instanceof Samph_Types.A9) {
                return arith(dictMonadState)(ins.value0)(function (i) {
                    return i << 1;
                });
            };
            if (ins instanceof Samph_Types.B9) {
                return arith(dictMonadState)(ins.value0)(function (i) {
                    return i >> 1;
                });
            };
            if (ins instanceof Samph_Types.C9) {
                return arith(dictMonadState)(ins.value0)(function (i) {
                    return i << 1;
                });
            };
            if (ins instanceof Samph_Types.D9) {
                return arith(dictMonadState)(ins.value0)(function (i) {
                    return i >> 1;
                });
            };
            if (ins instanceof Samph_Types.B0) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v + ins.value1 | 0;
                });
            };
            if (ins instanceof Samph_Types.B1) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v - ins.value1;
                });
            };
            if (ins instanceof Samph_Types.B2) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v * ins.value1 | 0;
                });
            };
            if (ins instanceof Samph_Types.B3) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return v / ins.value1 | 0;
                });
            };
            if (ins instanceof Samph_Types.B6) {
                return arith(dictMonadState)(ins.value0)(function (n) {
                    return n % ins.value1;
                });
            };
            if (ins instanceof Samph_Types.BA) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return Data_Int_Bits.and(v)(ins.value1);
                });
            };
            if (ins instanceof Samph_Types.BB) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return Data_Int_Bits.or(v)(ins.value1);
                });
            };
            if (ins instanceof Samph_Types.BC) {
                return arith(dictMonadState)(ins.value0)(function (v) {
                    return Data_Int_Bits.xor(v)(ins.value1);
                });
            };
            if (ins instanceof Samph_Types.C0) {
                return jmp(dictMonadState)(ins.value0);
            };
            if (ins instanceof Samph_Types.C1) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(use(dictMonadState)(function (dictFunctor) {
                    return zeroFlag(dictFunctor);
                })))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.C2) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(uses(dictMonadState)(function (dictFunctor) {
                    return zeroFlag(dictFunctor);
                })(Data_HeytingAlgebra.not(Data_HeytingAlgebra.heytingAlgebraBoolean))))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.C3) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(use(dictMonadState)(function (dictFunctor) {
                    return underflow(dictFunctor);
                })))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.C4) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(uses(dictMonadState)(function (dictFunctor) {
                    return underflow(dictFunctor);
                })(Data_HeytingAlgebra.not(Data_HeytingAlgebra.heytingAlgebraBoolean))))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.C5) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(use(dictMonadState)(function (dictFunctor) {
                    return overflow(dictFunctor);
                })))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.C6) {
                return Data_Function.apply(Control_Bind.join((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]()))(Control_Apply.apply(((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())(Data_Functor.map((((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())["__superclass_Control.Apply.Apply_0"]())["__superclass_Data.Functor.Functor_0"]())(Control_Applicative.when((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]()))(uses(dictMonadState)(function (dictFunctor) {
                    return overflow(dictFunctor);
                })(Data_HeytingAlgebra.not(Data_HeytingAlgebra.heytingAlgebraBoolean))))(Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(jmp(dictMonadState)(ins.value0))));
            };
            if (ins instanceof Samph_Types.CA) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return instructionPointer(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(push(v)(dictMonadState)(dictMonadError))(function () {
                        return jmp(dictMonadState)(ins.value0);
                    });
                });
            };
            if (ins instanceof Samph_Types.CB) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(pop(dictMonadState)(dictMonadError))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return instructionPointer(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.CD) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(pop(dictMonadState)(dictMonadError))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return instructionPointer(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.CC) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return instructionPointer(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(push(v)(dictMonadState)(dictMonadError))(function () {
                        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(ins.value0))(function (v1) {
                            return push(v1)(dictMonadState)(dictMonadError);
                        });
                    });
                });
            };
            if (ins instanceof Samph_Types.E0) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                }))(function (v) {
                    return push(v)(dictMonadState)(dictMonadError);
                });
            };
            if (ins instanceof Samph_Types.E1) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(pop(dictMonadState)(dictMonadError))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return regLens(ins.value0)(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.EA) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return statusRegister(dictFunctor);
                }))(function (v) {
                    return push(v)(dictMonadState)(dictMonadError);
                });
            };
            if (ins instanceof Samph_Types.EB) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(pop(dictMonadState)(dictMonadError))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return statusRegister(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.F0) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getIO(dictMonadError)(dictMonadState)(ins.value0))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return regLens(Samph_Types.AL.value)(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.F1) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(Samph_Types.AL.value)(dictFunctor);
                }))(function (v) {
                    return setIO(dictMonadError)(dictMonadState)(ins.value0)(v);
                });
            };
            if (ins instanceof Samph_Types.FE) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Data_Unit.unit);
            };
            if (ins instanceof Samph_Types.O0) {
                return Control_Monad_Error_Class.throwError(dictMonadError)(Finished.value);
            };
            if (ins instanceof Samph_Types.FF) {
                return Control_Applicative.pure((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Applicative.Applicative_0"]())(Data_Unit.unit);
            };
            if (ins instanceof Samph_Types.FC) {
                return setState(dictMonadState)(function (dictFunctor) {
                    return interrupt(dictFunctor);
                })(true);
            };
            if (ins instanceof Samph_Types.FD) {
                return setState(dictMonadState)(function (dictFunctor) {
                    return interrupt(dictFunctor);
                })(false);
            };
            if (ins instanceof Samph_Types.D0) {
                return setState(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                })(ins.value1);
            };
            if (ins instanceof Samph_Types.D1) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(ins.value1))(function (v) {
                    return setState(dictMonadState)(function (dictFunctor) {
                        return regLens(ins.value0)(dictFunctor);
                    })(v);
                });
            };
            if (ins instanceof Samph_Types.D2) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                }))(function (v) {
                    return setRam(dictMonadError)(dictMonadState)(ins.value0)(v);
                });
            };
            if (ins instanceof Samph_Types.D3) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value1)(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(v))(function (v1) {
                        return setState(dictMonadState)(function (dictFunctor) {
                            return regLens(ins.value0)(dictFunctor);
                        })(v1);
                    });
                });
            };
            if (ins instanceof Samph_Types.D4) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                        return regLens(ins.value1)(dictFunctor);
                    }))(function (v1) {
                        return setRam(dictMonadError)(dictMonadState)(v)(v1);
                    });
                });
            };
            if (ins instanceof Samph_Types.DA) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                        return regLens(ins.value1)(dictFunctor);
                    }))(function (v1) {
                        return c(Data_Ord.compare(Samph_Types.ordLit)(v)(v1));
                    });
                });
            };
            if (ins instanceof Samph_Types.DB) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                }))(function (v) {
                    return c(Data_Ord.compare(Samph_Types.ordLit)(v)(ins.value1));
                });
            };
            if (ins instanceof Samph_Types.DC) {
                return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(use(dictMonadState)(function (dictFunctor) {
                    return regLens(ins.value0)(dictFunctor);
                }))(function (v) {
                    return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(getRam(dictMonadError)(dictMonadState)(ins.value1))(function (v1) {
                        return c(Data_Ord.compare(Samph_Types.ordLit)(v)(v1));
                    });
                });
            };
            throw new Error("Failed pattern match at Samph.Runtime line 256, column 15 - line 350, column 24: " + [ ins.constructor.name ]);
        };
    };
};
var step = function (dictMonadState) {
    return function (dictMonadError) {
        return Control_Bind.bind((dictMonadError["__superclass_Control.Monad.Monad_0"]())["__superclass_Control.Bind.Bind_1"]())(popIns(dictMonadState)(dictMonadError))(function (v) {
            return runInst(v)(dictMonadState)(dictMonadError);
        });
    };
};
module.exports = {
    CorruptedCode: CorruptedCode, 
    StackOverflow: StackOverflow, 
    StackUnderflow: StackUnderflow, 
    IndexOutOfBounds: IndexOutOfBounds, 
    InvalidPort: InvalidPort, 
    Finished: Finished, 
    arith: arith, 
    binArith: binArith, 
    getArr: getArr, 
    getIO: getIO, 
    getLit: getLit, 
    getRam: getRam, 
    initialState: initialState, 
    instructionPointer: instructionPointer, 
    interrupt: interrupt, 
    io: io, 
    jmp: jmp, 
    overflow: overflow, 
    plusState: plusState, 
    pop: pop, 
    popIns: popIns, 
    popLit: popLit, 
    popReg: popReg, 
    push: push, 
    ram: ram, 
    regLens: regLens, 
    runInst: runInst, 
    set: set, 
    setArr: setArr, 
    setIO: setIO, 
    setRam: setRam, 
    setState: setState, 
    stackPointer: stackPointer, 
    statusRegister: statusRegister, 
    step: step, 
    subState: subState, 
    underflow: underflow, 
    use: use, 
    uses: uses, 
    zeroFlag: zeroFlag
};
